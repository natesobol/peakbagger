<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Peakbagger's Journal Web</title>

<!-- SEO -->
<meta name="description" content="Peakbagger's Journal Web ‚Äî a private, offline-friendly checklist to track progress on the NH 48 and other peak lists. Toggle units, export to XLSX, and learn more about each mountain." />
<link rel="canonical" href="https://www.nh48pics.com/peakbagger" />
<meta name="robots" content="index,follow,max-image-preview:large" />

<!-- Open Graph -->
<meta property="og:type" content="website" />
<meta property="og:title" content="Peakbagger's Journal Web" />
<meta property="og:description" content="Track your NH 48 and other lists privately, offline-friendly. Clean UI, XLSX export, mountain detail panel, and more." />
<meta property="og:url" content="https://www.nh48pics.com/peakbagger" />
<meta property="og:site_name" content="NH48pics" />
<meta property="og:image" content="https://www.nh48pics.com/_files/og/peakbagger-og.jpg" />

<!-- Twitter -->
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Peakbagger's Journal Web" />
<meta name="twitter:description" content="Private, offline-friendly checklist for NH 48 and more." />
<meta name="twitter:image" content="https://www.nh48pics.com/_files/og/peakbagger-og.jpg" />

<!-- JSON-LD: SoftwareApplication -->
<script type="application/ld+json">
{
  "@context":"https://schema.org",
  "@type":"SoftwareApplication",
  "name":"Peakbagger's Journal Web",
  "applicationCategory":"LifestyleApplication",
  "operatingSystem":"Web",
  "author":{"@type":"Person","name":"Nathan Sobol"},
  "description":"A private, offline-friendly checklist to track peakbagging progress (e.g., NH 48), including units toggle, XLSX export, and a mountain detail panel.",
  "offers":{"@type":"Offer","price":"0","priceCurrency":"USD"},
  "url":"https://www.nh48pics.com/peakbagger"
}
</script>

<!-- External stylesheet -->
<link rel="stylesheet" href="styles.css">
</head>
<body>

<div class="app">
  <div class="topbar">
    <div class="row1">
      <div class="progress-wrap">
        <div class="progress-head">
          <span id="unitToggle" class="ctrl-btn" title="Toggle units"><span class="ico">‚öôÔ∏è</span><span id="unitLabel">Feet (ft)</span></span>

          <!-- NEW: centered list title -->
          <div id="listTitle" class="list-title">‚Äî</div>

          <span id="progressText" class="subtle">0/0 ‚Ä¢ 0%</span>
        </div>
        <div class="progress" aria-label="progress"><div class="bar" id="bar"></div></div>
      </div>
      <div class="controls">
        <div class="ctrl"><span class="ico">üîé</span><input id="search" type="search" placeholder="Search peaks‚Ä¶" /></div>
        <div class="ctrl-btn" id="sortBtn" title="Toggle sort"><span class="ico">‚öôÔ∏è</span> <span>Sort: <strong id="sortLabel">Rank</strong></span></div>
        <div class="ctrl-btn" id="showComplete"><span class="ico">‚óØ</span> <span>Hide completed</span></div>
        <!-- NEW: Mode toggle (Checklist / Grid) -->
        <div class="ctrl-btn" id="modeBtn" title="Switch between checklist and grid"><span class="ico">üîÅ</span> <span>Mode: <strong id="modeLabel">Checklist</strong></span></div>
        <div class="ctrl-btn" id="exportBtn"><span class="ico">üóÑÔ∏è</span> <span>Export XLSX</span></div>
      </div>
    </div>
  </div>

  <div class="content">
    <aside class="sidebar">
      <div class="brand">
        <img src="https://static.wixstatic.com/media/66b1b2_6dfce097ed584b5296afeb83f26e4c8a~mv2.png" alt="logo" style="width:32px;height:32px;border-radius:8px;border:1px solid var(--border-strong)" loading="lazy" />
        <div>
          <h1 style="margin:0">Peakbagger (Web)</h1>
          <div class="subtle">Private to this embed</div>
        </div>
      </div>

      <a class="app-promo" href="https://apps.apple.com/us/app/peakbaggers-journal/idXXXXXXXXX" target="_blank" rel="noopener">
        <img class="app-promo__icon" src="https://static.wixstatic.com/media/66b1b2_6dfce097ed584b5296afeb83f26e4c8a~mv2.png" alt="Peakbagger's Journal iOS icon" loading="lazy">
        <div class="app-promo__meta">
          <div class="app-promo__title">Peakbagger's Journal (iOS)</div>
          <div class="app-promo__sub">Available on the App Store</div>
        </div>
        <span class="btn btn-primary btn-small app-promo__cta">View</span>
      </a>

      <div class="auth" id="authCard">
        <div id="authSignedOut">
          <div class="row">
            <div>
              <div class="subtle">You're not signed in</div>
              <div style="font-size:13px;color:var(--ink)">Sign in to save your progress</div>
            </div>
            <button class="btn btn-primary btn-small" id="openAuth">Log in</button>
          </div>
        </div>
        <div id="authSignedIn" style="display:none">
          <a href="profile.html" id="userProfileLink" style="text-decoration:none;color:inherit;display:block;cursor:pointer;transition:background 0.2s;border-radius:8px;padding:8px;margin:-8px" title="View profile settings">
            <div class="row" style="align-items:center;gap:12px">
              <div id="userAvatarIcon" style="width:48px;height:48px;border-radius:50%;background:linear-gradient(135deg,var(--accent),#6b8cff);display:flex;align-items:center;justify-content:center;font-size:18px;color:white;font-weight:600;border:2px solid var(--border);flex-shrink:0">
                <span id="userInitials">U</span>
              </div>
              <div style="flex:1;min-width:0">
                <div id="meName" style="font-weight:600;margin-top:2px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap"></div>
                <div id="meEmail" class="subtle" style="font-size:12px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap"></div>
              </div>
              <div style="color:var(--ink-weak);font-size:20px;flex-shrink:0">‚Ä∫</div>
            </div>
          </a>
        </div>
      </div>

      <!-- About Peakbagger Info Panel -->
      <details class="collapsible-section" id="introPanelDetails">
        <summary>
          <span>‚ÑπÔ∏è About Peakbagger</span>
          <span id="introPanelToggle" style="font-size:12px;color:var(--ink-weak)">‚ñº</span>
        </summary>
        <div class="panel" style="font-size:14px;line-height:1.5;color:var(--ink)">
          <p>Peakbagger is a tool to track your summits of peaks in the White Mountains. Use it to log your ascents, track your progress through peak lists, and discover which peaks you've conquered.</p>
          <p style="margin-top:10px">Whether you're working toward the NH 48, the 52 with a View, or other peak bagging challenges, Peakbagger helps you stay organized and motivated on your peak-hunting adventures.</p>
        </div>
      </details>

      <div style="margin-top:14px">
        <label for="listSelect" class="subtle" style="font-size:14px">Choose List:</label>
        <select id="listSelect" class="select" style="width:100%;margin-top:6px"></select>
      </div>

      <!-- Mobile Search -->
      <div id="mobileSidebarSearch" style="display:none">
        <label for="mobileSearch" class="subtle" style="font-size:14px">Search:</label>
        <input id="mobileSearch" type="search" placeholder="Search peaks‚Ä¶" style="width:100%;margin-top:6px;padding:8px 12px;border:1px solid var(--border);border-radius:6px;background:var(--input-bg);color:var(--ink);font-size:14px;" />
      </div>

      <details id="settingsDetails" class="collapsible-section"><summary>Settings</summary><div class="settings">
        <div class="row">
          <label>Units: meters</label>
          <label class="switch"><input id="metersToggle" type="checkbox"><span class="slider"></span></label>
        </div>

        <!-- NEW: Row density -->
        <div class="row">
          <label>Row density: <strong id="densityLabel">Comfortable</strong></label>
          <label class="switch"><input id="densityToggle" type="checkbox"><span class="slider"></span></label>
        </div>
        <!-- NEW: Sticky header -->
        <div class="row">
          <label>Sticky header</label>
          <label class="switch"><input id="stickyToggle" type="checkbox"><span class="slider"></span></label>
        </div>
        <!-- NEW: Grid Tracking Mode -->
        <div class="row">
          <label>Grid tracking (12 months/peak)</label>
          <label class="switch"><input id="gridTrackingToggle" type="checkbox"><span class="slider"></span></label>
        </div>
      </div></details>

      <!-- Themes dropdown (pre-collapsed) -->
      <details id="themeDetails" class="collapsible-section"><summary>Themes</summary>
        <div class="panel" style="margin-top:8px">
          <label for="themeSelect" class="subtle">Choose theme</label>
          <select id="themeSelect" class="select" style="width:100%;margin-top:6px">
            <option value="dark">Dark (default)</option>
            <option value="light">Light (white & black)</option>
            <option value="forest">Forest Green</option>
            <option value="sky">Sky Blue</option>
          </select>
        </div>
      </details>

      <!-- NEW: Resources panel -->
      <details id="resourcesDetails" class="collapsible-section"><summary>Resources</summary><div class="panel" style="margin-top:14px">
        <div class="links-col">
          <a class="btn-link" href="https://trailsnh.com/" target="_blank" rel="noopener">TrailsNH (trip reports)</a>
          <a class="btn-link" href="https://www.weather.gov/" target="_blank" rel="noopener">NOAA Weather</a>
          <a class="btn-link" href="https://www.peakbagger.com/" target="_blank" rel="noopener">Peakbagger (lists & facts)</a>
          <a class="btn-link" href="https://www.mountwashington.org/" target="_blank" rel="noopener">Mount Washington Observatory</a>
          <a class="btn-link" href="https://www.fs.usda.gov/whitemountain" target="_blank" rel="noopener">WMNF Alerts/Notices</a>
        </div>
        <p class="subtle xsmall" style="margin-top:8px">External links open in a new tab.</p>
        </div></details>

      <!-- NEW: Copyright -->
      <div class="copyright">¬© <span id="copyrightYear"></span> Nathan Sobol</div>
    </aside>

    <main class="panel">
      <!-- Pagination header (Top) -->
      <div class="pager-wrap">
        <div class="pager-stats" id="pg-stats-top">Showing ‚Äî</div>
        <div class="page-list"  id="pg-list-top"  aria-label="Pagination (top)"></div>
      </div>

      <!-- Grid view (card layout) -->
      <div id="grid-view" class="grid-view"></div>

      <!-- List view (table format) -->
      <div id="list-view" class="list-view"></div>

      <!-- Full-page Peak Detail View -->
      <div id="peakDetailPage" class="peak-detail-page" style="display:none">
        <div class="peak-detail-header">
          <button id="peakDetailBackBtn" class="btn btn-ghost btn-small" style="margin-bottom:16px">‚Üê Back to Peakbagger</button>
          <h1 id="peakDetailTitle" style="margin:0 0 8px 0">‚Äî</h1>
          <p id="peakDetailSub" class="subtle" style="margin:0">Quick facts, weather & helpful links.</p>
        </div>

        <div id="peakDetailPhotos" class="peak-detail-photos"></div>

        <div class="peak-detail-grid">
          <!-- Fast facts -->
          <section class="fact">
            <h3>Fast facts</h3>
            <div class="kv"><span>Elevation</span><strong id="peakDetailElev">‚Äî</strong></div>
            <div class="kv"><span>Date completed</span><input type="date" id="peakDetailDateInput" class="date-input" value="" /></div>
            <div id="peakDetailMonthGrid" class="peak-detail-month-grid" style="margin-top:16px;display:none;">
              <h4 style="margin:0 0 10px 0;font-size:0.85rem;color:var(--ink-light);text-transform:uppercase;letter-spacing:0.5px;">Monthly Completions</h4>
              <div class="detail-month-grid"></div>
            </div>
            <div class="kv"><span>Location</span><strong id="peakDetailLocation">‚Äî</strong></div>
            <div class="kv"><span>Prominence</span><strong id="peakDetailProm">‚Äî</strong></div>
            <div class="kv"><span>Difficulty</span><strong id="peakDetailDiff">‚Äî</strong></div>
          </section>

          <!-- Weather -->
          <section class="fact">
            <h3>Weather</h3>
            <p class="subtle small">Forecast links open in a new tab. NOAA point forecasts work best near the summit.</p>
            <div class="links-col">
              <a class="btn-link" id="peakWxNoaa" href="https://www.weather.gov/" target="_blank" rel="noopener">NOAA Point Forecast</a>
              <a class="btn-link" id="peakWxOpenMeteo" href="https://open-meteo.com/en/docs" target="_blank" rel="noopener">Open-Meteo (lat/lon)</a>
              <a class="btn-link" id="peakWxTrailsNH" href="https://trailsnh.com/" target="_blank" rel="noopener">TrailsNH Summit Forecast</a>
              <a class="btn-link" id="peakWxMWOBS" href="https://www.mountwashington.org/experience-the-weather/" target="_blank" rel="noopener">MWOBS (Presidentials)</a>
            </div>
          </section>

          <!-- Learn more -->
          <section class="fact">
            <h3>Learn more</h3>
            <div class="links-col">
              <a class="btn-link" id="peakLnkWikipedia" href="https://en.wikipedia.org/wiki/" target="_blank" rel="noopener">Wikipedia</a>
              <a class="btn-link" id="peakLnkPeakbagger" href="https://www.peakbagger.com/" target="_blank" rel="noopener">Peakbagger</a>
              <a class="btn-link" id="peakLnkAllTrails" href="https://www.alltrails.com/" target="_blank" rel="noopener">AllTrails</a>
              <a class="btn-link" id="peakLnkSummitPost" href="https://www.summitpost.org/" target="_blank" rel="noopener">SummitPost</a>
              <a class="btn-link" id="peakLnkMaps" href="https://www.openstreetmap.org/" target="_blank" rel="noopener">OpenStreetMap</a>
            </div>
          </section>
        </div>
      </div>

      <!-- Table view (hidden by default) -->
      <table id="table-view" style="display:none">
        <thead>
          <tr>
            <th style="width:64px">Rank</th>
            <th>Mountain</th>
            <th style="width:140px">Elevation</th>
            <th style="width:160px">Date / Months</th>
            <th style="width:120px">Completed</th>
            <th style="width:48px"></th>
          </tr>
        </thead>
        <tbody id="rows"></tbody>
      </table>

      <!-- Pagination footer (Bottom) -->
      <div class="pager-wrap">
        <div class="pager-stats" id="pg-stats-bot">Showing ‚Äî</div>
        <div class="page-list"  id="pg-list-bot"  aria-label="Pagination (bottom)"></div>
      </div>
    </main>
  </div>

<!-- Auth Modal -->
<div class="modal" id="authModal" aria-hidden="true">
  <div class="sheet" role="dialog" aria-modal="true" aria-labelledby="authTitle">
    <h2 id="authTitle">Log in</h2>
    
    <!-- LOGIN FORM (default) -->
    <div id="loginForm">
      <div class="subtle" style="margin-bottom:16px">Log in to access your peak tracking data.</div>
      
      <div class="field"><label for="loginEmail">Email *</label><input id="loginEmail" type="email" placeholder="you@email.com" autocomplete="email" required></div>
      <div class="field"><label for="loginPass">Password *</label><input id="loginPass" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autocomplete="current-password" required></div>
      
      <label style="display:flex;align-items:center;gap:8px;margin:12px 0">
        <input type="checkbox" id="rememberMe" checked />
        <span>Stay signed in</span>
      </label>
      
      <div class="row-actions" style="margin-top:16px">
        <button class="btn btn-primary" id="doLogin">Log in</button>
        <span class="space"></span>
        <button class="btn btn-ghost" id="closeAuth">Close</button>
      </div>
      
      <div style="margin-top:16px;text-align:center">
        <span class="subtle">Don't have an account? </span>
        <a href="#" id="showSignup" style="color:#4a9eff;text-decoration:none">Create account</a>
      </div>
    </div>
    
    <!-- SIGN UP FORM (hidden by default) -->
    <div id="signupForm" style="display:none">
      <div class="subtle" style="margin-bottom:16px">Create your account to start tracking peaks.</div>
      
      <div class="field"><label for="signupFirstName">First Name *</label><input id="signupFirstName" type="text" placeholder="John" autocomplete="given-name" required></div>
      <div class="field"><label for="signupLastName">Last Name</label><input id="signupLastName" type="text" placeholder="Doe" autocomplete="family-name"></div>
      <div class="field"><label for="signupEmail">Email *</label><input id="signupEmail" type="email" placeholder="you@email.com" autocomplete="email" required></div>
      <div class="field"><label for="signupPass">Password *</label><input id="signupPass" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autocomplete="new-password" required></div>
      <div class="field"><label for="signupPassConfirm">Confirm Password *</label><input id="signupPassConfirm" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autocomplete="new-password" required></div>
      
      <!-- Honeypot for bot prevention -->
      <div style="position:absolute;left:-9999px" aria-hidden="true">
        <input type="text" id="signupHoneypot" tabindex="-1" autocomplete="off" />
      </div>
      
      <div class="tos-toggle" id="tosToggle" style="margin-top:12px">üìÑ View Terms & Conditions</div>
      <div class="tos-box" id="tosBox">
        <div id="tosText"></div>
      </div>
      <label class="tos-agree">
        <input type="checkbox" id="tosAgree" />
        <span>I agree to the Terms & Conditions *</span>
      </label>
      
      <div class="row-actions" style="margin-top:16px">
        <button class="btn btn-primary" id="doSignup" disabled>Create account</button>
        <span class="space"></span>
        <button class="btn btn-ghost" id="closeAuth">Close</button>
      </div>
      
      <div style="margin-top:16px;text-align:center">
        <span class="subtle">Already have an account? </span>
        <a href="#" id="showLogin" style="color:#4a9eff;text-decoration:none">Log in</a>
      </div>
    </div>
    
    <div id="authMsg" class="note" style="margin-top:12px"></div>
  </div>
</div>

<!-- XLSX lib -->
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

<!-- Supabase client -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<!-- Settings labels sync (capitalized) -->
<script>
document.addEventListener('DOMContentLoaded',()=>{
  const metersToggle=document.getElementById('metersToggle');
  const themeSelect = document.getElementById('themeSelect');
  const metersLabel=metersToggle.closest('.row').querySelector('label');
  const updMeters=()=>{metersLabel.textContent='Units: '+(metersToggle.checked?'Meters':'Feet')};
  updMeters();
  metersToggle.addEventListener('change',updMeters);
  // sync theme select default from prefs if present
  try{ const prefs = JSON.parse(localStorage.getItem('pb_prefs_v1')||'{}'); if (themeSelect && prefs.theme) themeSelect.value = prefs.theme; }catch(e){}
});
</script>

<!-- App Module -->
<script type="module" src="app.js"></script>

<!-- Reset helper (unchanged + grid key) -->
<button id="pbReset" style="border:1px solid #ff8a8a;border-radius:8px;padding:8px 10px;background:#1a1a1a;color:#fff;cursor:pointer">
  Reset all local data
</button>
<script>
  (function(){
    const KEYS_PREFIX = ['peakbagger_web_state_v3_', 'peakbagger_web_grid_v1_', 'pb_'];
    document.getElementById('pbReset')?.addEventListener('click', () => {
      if (!confirm('This will erase your saved progress, dates, sign-in, and preferences on this device. Continue?')) return;
      try {
        const toDelete = [];
        for (let i = 0; i < localStorage.length; i++) {
          const k = localStorage.key(i);
          if (k && KEYS_PREFIX.some(p => k.startsWith(p))) toDelete.push(k);
        }
        toDelete.forEach(k => localStorage.removeItem(k));
        ['pb_users_v1','pb_session_v1','pb_prefs_v1'].forEach(k => localStorage.removeItem(k));
        alert('All Peakbagger data on this device has been cleared.');
        location.reload();
      } catch (e) {
        alert('Could not clear local data. You can manually clear site data in your browser settings.');
      }
    });
  })();
</script>

<!-- Auto-collapse details on mobile (NEW) -->
<script>
  document.addEventListener('DOMContentLoaded', () => {
    const settingsEl = document.getElementById('settingsDetails');
    const resourcesEl = document.getElementById('resourcesDetails');
    function toggleDetailsByWidth() {
      const isMobile = window.innerWidth < 960;
      if (settingsEl) {
        if (isMobile) settingsEl.removeAttribute('open'); else settingsEl.setAttribute('open', '');
      }
      if (resourcesEl) {
        if (isMobile) resourcesEl.removeAttribute('open'); else resourcesEl.setAttribute('open', '');
      }
    }
    toggleDetailsByWidth();
    window.addEventListener('resize', toggleDetailsByWidth);
  });
</script>

<!-- Noscript notice -->
<noscript>
  <div style="margin:12px; padding:12px; border:1px solid #e6a100; border-radius:8px; background:#2a2000; color:#ffd87a">
    Peakbagger's Journal needs JavaScript for list loading and saving progress. Please enable JavaScript to use the app.
  </div>
</noscript>

<!-- Version badge -->
<div class="app-version" aria-hidden="true">v0.8.0.1</div>

</body>
</html>
